# SQL-PROJECT

INTRODUCTION
Steve runs a top-end car showroom but his data analyst has just quit and left him without his crucial insights.
Can you analyse the following data to provide him with all the answers he requires?

-- 1. What are the details of all cars purchased in the year 2022?
SELECT s.car_id,c.make,c.type,c.style,c.cost_$,extract(year from s.purchase_date) "year"
FROM sales s
left join cars c
on c.car_id=s.car_id
where extract(year from purchase_date) =2022
ORDER BY s.car_id;


-- 2. What is the total number of cars sold by each salesperson?
SELECT s.salesman_id,sa.name,count(1) "NO_OF_CARS_SOLD"
FROM sales s
INNER JOIN salespersons sa
ON s.salesman_id=sa.salesman_id
GROUP BY s.salesman_id ;
-- TOM LEE HAS SOLD MORE NO OF CARS AND LUCY CHAN HAS SOLD LESS NO OF CARS

-- 3. What is the total revenue generated by each salesperson?
SELECT s.salesman_id,sa.name,sum(c.cost_$) AS "TOTAL_SALES"
FROM sales s
LEFT JOIN cars c
ON s.car_id=c.car_id
LEFT JOIN salespersons sa
ON sa.salesman_id=s.salesman_id
GROUP BY s.salesman_id
ORDER BY sum(c.cost_$) DESC;

-- 4. What are the details of the cars sold by each salesperson?
SELECT sa.salesman_id,sa.name,c.*
FROM salespersons sa
LEFT JOIN SALES S
ON sa.salesman_id=s.salesman_id
LEFT JOIN cars c
ON c.car_id=s.car_id;

-- 5. What is the total revenue generated by each car type?
SELECT c.type,SUM(cost_$) as "REVENUE GENERATED BY EACH CAR TYPE"
FROM cars C,SALES S
WHERE C.car_id=s.car_id
GROUP BY c.type
ORDER BY SUM(cost_$) DESC;

-- 6. What are the details of the cars sold in the year 2021 by salesperson ‘Emily Wong’?

SELECT c.car_id,c.make,c.style,c.cost_$,sa.name
FROM sales S,salespersons sa,cars c
WHERE s.salesman_id=sa.salesman_id and s.car_id=c.car_id
	  and EXTRACT(YEAR FROM S.purchase_date) =2021 and sa.name="Emily Wong";
        
-- 7. What is the total revenue generated by the sales of hatchback cars?
SELECT c.style,SUM(cost_$) as "total revenue"
FROM cars c,sales s
WHERE c.car_id=s.car_id and c.style ="hatchback";

-- 8. What is the total revenue generated by the sales of SUV cars in the year 2022?
SELECT c.style,sum(cost_$) "total revenue"
FROM cars c ,sales s
WHERE c.car_id=s.car_id and c.style="suv" and EXTRACT(YEAR FROM purchase_date)=2022;

-- 9. What is the name and city of the salesperson 
-- who sold the most number of cars in the year 2023?
SELECT sa.name,sa.city,count(1) AS "NO_OF_CARS_SOLD"
FROM sales s,salespersons sa
WHERE EXTRACT(YEAR FROM purchase_date) =2023 and sa.salesman_id=s.salesman_id
GROUP BY sa.name,sa.city
ORDER BY count(1) DESC
LIMIT 1;

-- 10. What is the name and age of the salesperson who generated the
--  highest revenue in the year 2022?
SELECT sa.name,sa.age,SUM(c.cost_$) as "revenue generated"
FROM sales s,salespersons sa,cars c
WHERE EXTRACT(YEAR FROM purchase_date) =2022 and sa.salesman_id=s.salesman_id and
c.car_id=s.car_id
GROUP BY sa.name,sa.age
ORDER BY SUM(c.cost_$) DESC
LIMIT 1;



















